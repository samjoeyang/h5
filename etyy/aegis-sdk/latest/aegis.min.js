/**
 *  ===========================================================================
 * @tencent/aegis-web-sdk@1.38.64 (c) 2023 TencentCloud Real User Monitoring.
 * Author pumpkincai.
 * Last Release Time Tue Feb 21 2023 17:19:30 GMT+0800 (GMT+08:00).
 * Released under the MIT License.
 * Thanks for supporting RUM & Aegis!
 * ===========================================================================
 **/
!function(e, n) {
  "object" == typeof exports && "undefined" != typeof module ? module.exports = n() : "function" == typeof define && define.amd ? define(n) : (e = "undefined" != typeof globalThis ? globalThis : e || self).Aegis = n()
}(this, function() {
  "use strict";
  var j, q;
  function H(e) {
      this.name = "__st" + (1e9 * Math.random() >>> 0) + j + "__",
      null != e && e.forEach(this.add, this),
      j += 1
  }
  Array.prototype.find || Object.defineProperty(Array.prototype, "find", {
      configurable: !0,
      writable: !0,
      value: function(e) {
          if (null === this)
              throw new TypeError('"this" is null or not defined');
          var n = Object(this)
            , t = n.length >>> 0;
          if ("function" != typeof e)
              throw new TypeError("predicate must be a function");
          for (var o = arguments[1], i = 0; i < t; ) {
              var r = n[i];
              if (e.call(o, r, i, n))
                  return r;
              i += 1
          }
      }
  }),
  String.prototype.startsWith || Object.defineProperty(String.prototype, "startsWith", {
      value: function(e, n) {
          return this.substring(n = !n || n < 0 ? 0 : +n, n + e.length) === e
      }
  }),
  window.WeakSet || (j = Date.now() % 1e9,
  H.prototype.add = function(e) {
      var n = this.name;
      return e[n] || Object.defineProperty(e, n, {
          value: !0,
          writable: !0
      }),
      this
  }
  ,
  H.prototype.delete = function(e) {
      return !!e[this.name] && !(e[this.name] = void 0)
  }
  ,
  H.prototype.has = function(e) {
      return !!e[this.name]
  }
  ,
  q = H,
  Object.defineProperty(window, "WeakSet", {
      value: function(e) {
          return new q(e)
      }
  })),
  Object.assign || Object.defineProperty(Object, "assign", {
      enumerable: !1,
      configurable: !0,
      writable: !0,
      value: function(e) {
          if (null == e)
              throw new TypeError("Cannot convert first argument to object");
          for (var n = Object(e), t = 1; t < arguments.length; t++)
              if (null != (o = arguments[t]))
                  for (var o = Object(o), i = Object.keys(Object(o)), r = 0, a = i.length; r < a; r++) {
                      var s = i[r]
                        , u = Object.getOwnPropertyDescriptor(o, s);
                      null != u && u.enumerable && (n[s] = o[s])
                  }
          return n
      }
  });
  var F = function(e, n) {
      return (F = Object.setPrototypeOf || ({
          __proto__: []
      }instanceof Array ? function(e, n) {
          e.__proto__ = n
      }
      : function(e, n) {
          for (var t in n)
              Object.prototype.hasOwnProperty.call(n, t) && (e[t] = n[t])
      }
      ))(e, n)
  }
    , E = function() {
      return (E = Object.assign || function(e) {
          for (var n, t = 1, o = arguments.length; t < o; t++)
              for (var i in n = arguments[t])
                  Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
          return e
      }
      ).apply(this, arguments)
  };
  function c() {
      for (var e = 0, n = 0, t = arguments.length; n < t; n++)
          e += arguments[n].length;
      for (var o = Array(e), i = 0, n = 0; n < t; n++)
          for (var r = arguments[n], a = 0, s = r.length; a < s; a++,
          i++)
              o[i] = r[a];
      return o
  }
  function B(n) {
      try {
          return encodeURIComponent(decodeURIComponent(n))
      } catch (e) {
          return n
      }
  }
  var t, D = ["ext1", "ext2", "ext3", "level", "trace", "tag", "seq", "code"], M = (e.prototype.indexOf = function(e, n) {
      for (var t = 0; t < e.length; t++)
          if (e[t].callback === n)
              return t;
      return -1
  }
  ,
  e.prototype.on = function(e, n, t) {
      var o;
      if (void 0 === t && (t = 0),
      this)
          return (o = this.eventsList[e]) || (this.eventsList[e] = [],
          o = this.eventsList[e]),
          -1 === this.indexOf(o, n) && o.push({
              name: e,
              type: t || 0,
              callback: n
          }),
          this
  }
  ,
  e.prototype.one = function(e, n) {
      this.on(e, n, 1)
  }
  ,
  e.prototype.remove = function(e, n) {
      if (this) {
          var t = this.eventsList[e];
          if (t) {
              if (n)
                  return t.length && (n = this.indexOf(t, n),
                  t.splice(n, 1)),
                  this;
              try {
                  delete this.eventsList[e]
              } catch (e) {}
          }
          return null
      }
  }
  ,
  e.prototype.clear = function() {
      this.eventsList = {}
  }
  ,
  e), W = function(e) {
      if (!e || 0 === e.length)
          return "{}";
      e = Array.isArray(e) ? e : [e];
      var n = Object.keys(e[0])
        , t = {};
      return n.forEach(function(n) {
          t[n] = e.map(function(e) {
              return e[n]
          })
      }),
      t.count = e.length,
      se(t)
  };
  function e() {
      var a = this;
      this.emit = function(e, n) {
          if (a) {
              var t;
              if (null != (o = a.eventsList[e]) && o.length)
                  for (var o = o.slice(), i = 0; i < o.length; i++) {
                      t = o[i];
                      try {
                          var r = t.callback.apply(a, [n]);
                          if (1 === t.type && a.remove(e, t.callback),
                          !1 === r)
                              break
                      } catch (e) {
                          throw e
                      }
                  }
              return a
          }
      }
      ,
      this.eventsList = {}
  }
  (o = t = t || {})[o.number = -1] = "number",
  o.string = "";
  function X(e, n) {
      return "number" == typeof e || "string" == typeof e ? e : n ? t.string : t.number
  }
  function S(e, n) {
      return "string" == typeof e ? e.split("?")[n ? 1 : 0] || "" : e
  }
  function V(e, n) {
      return void 0 === n && (n = 2048),
      String(e).slice(0, n)
  }
  function G(e) {
      return "string" == typeof e && e.startsWith("/") ? "https:" === (null === location || void 0 === location ? void 0 : location.protocol) : /^https/.test(e)
  }
  function J(e, n, t) {
      var o, i;
      try {
          if ("function" == typeof (null == n ? void 0 : n.retCodeHandler))
              return {
                  code: void 0 === (r = (i = n.retCodeHandler(e, null == t ? void 0 : t.url, null == t ? void 0 : t.ctx, null == t ? void 0 : t.payload) || {}).code) ? "unknown" : r,
                  isErr: i.isErr
              };
          "string" == typeof e && (e = JSON.parse(e)),
          "function" == typeof (null == (o = null == n ? void 0 : n.ret) ? void 0 : o.join) && (re = [].concat(n.ret.map(function(e) {
              return e.toLowerCase()
          })));
          var r, a = Object.getOwnPropertyNames(e).filter(function(e) {
              return -1 !== re.indexOf(e.toLowerCase())
          });
          return a.length ? {
              code: "" + (r = e[a[0]]),
              isErr: 0 !== r && "0" !== r
          } : {
              code: "unknown",
              isErr: !1
          }
      } catch (e) {
          return {
              code: "unknown",
              isErr: !1
          }
      }
  }
  function T(e, n, t) {
      try {
          var o = "function" == typeof n ? n(e, null == t ? void 0 : t.url) || "" : e;
          return ue(o).slice(0, 102400)
      } catch (e) {
          return ""
      }
  }
  function $(t, o) {
      var i, r = [], a = t.config;
      return t.lifeCycle.on("destroy", function() {
          r.length = 0
      }),
      function(e, n) {
          Array.isArray(e) ? r = r.concat(e) : r.push(e),
          o && r.length >= o || t.sendNow && 0 < r.length ? (r = fe(r),
          n(r.splice(0, r.length)),
          i && clearTimeout(i)) : (i && clearTimeout(i),
          i = setTimeout(function() {
              i = null,
              0 < (r = fe(r)).length && n(r.splice(0, r.length))
          }, a.delay))
      }
  }
  function K(e, n) {
      return Array.isArray(e) ? n(e.map(function(e) {
          return n = E(E({}, e), {
              msg: "string" == typeof e.msg ? e.msg : [].concat(e.msg).map(O).join(" ")
          }),
          D.forEach(function(e) {
              n[e] || delete n[e]
          }),
          n;
          var n
      })) : n([E(E({}, e), {
          msg: "string" == typeof e.msg ? e.msg : O(e.msg)
      })])
  }
  function Q(u, c) {
      return function(e, n) {
          var t, o, i, r = Array.isArray(e), a = r ? e : [e], s = (u.lifeCycle.emit("beforeRequest", e),
          u.config.beforeRequest);
          (a = "function" == typeof s ? a.map(function(n) {
              try {
                  var e = s({
                      logs: n,
                      logType: c
                  });
                  return (null == e ? void 0 : e.logType) === c && null != e && e.logs ? e.logs : !1 !== e && n
              } catch (e) {
                  return n
              }
          }).filter(function(e) {
              return !1 !== e
          }) : a).length && (t = a,
          e = D,
          !Array.isArray(t) || t.length <= 1 || (o = [],
          i = [],
          !(i = "string" == typeof e ? [e] : e)) || i.length <= 0 || (i.forEach(function(n) {
              t.forEach(function(e) {
                  null != e && e[n] && o.push(n)
              })
          }),
          0 < o.length && (t = t.map(function(e) {
              var n = {};
              return o.forEach(function(e) {
                  n[e] = ""
              }),
              E(E({}, n), e)
          }))),
          a = t,
          n(r ? a : a[0]))
      }
  }
  function Y(i) {
      return function(e, n) {
          i.lifeCycle.emit("modifyRequest", e);
          var t = i.config.modifyRequest;
          if ("function" == typeof t)
              try {
                  var o = t(e);
                  "object" == typeof o && "url"in o && (e = o)
              } catch (e) {
                  console.error(e)
              }
          n(e)
      }
  }
  function z(o) {
      return function(e, n) {
          null != (t = o.lifeCycle) && t.emit("afterRequest", e);
          var t = (o.config || {}).afterRequest;
          "function" == typeof t && !1 === t(e) || n(e)
      }
  }
  function v(t) {
      if (t && t.reduce && t.length)
          return 1 === t.length ? function(e, n) {
              t[0](e, n || ge)
          }
          : t.reduce(function(t, o) {
              return function(e, n) {
                  return void 0 === n && (n = ge),
                  t(e, function(e) {
                      return null == o ? void 0 : o(e, n)
                  })
              }
          });
      throw new TypeError("createPipeline need at least one function param")
  }
  function Z(n, t) {
      Object.getOwnPropertyNames(n).forEach(function(e) {
          "function" == typeof n[e] && "constructor" !== e && (t ? t[e] = "sendPipeline" === e ? function() {
              return function() {}
          }
          : function() {}
          : n[e] = function() {}
          )
      })
  }
  function ee() {
      return void 0 !== window.performance && "function" == typeof performance.clearResourceTimings && "function" == typeof performance.getEntriesByType && "function" == typeof performance.now
  }
  function ne(n, t) {
      function o(e) {
          "pagehide" !== e.type && "hidden" !== document.visibilityState || (n(e),
          t && (removeEventListener("visibilitychange", o, !0),
          removeEventListener("pagehide", o, !0)))
      }
      addEventListener("visibilitychange", o, !0),
      addEventListener("pagehide", o, !0)
  }
  function te(n) {
      return ve.some(function(e) {
          return -1 < n.indexOf(e)
      })
  }
  function n(e) {
      return -1 !== Ee.indexOf(e)
  }
  var L, R, l, oe = ["application/xhtml+xml", "application/xml", "application/pdf", "application/pkcs12", "application/javascript", "application/ecmascript", "application/vnd.mspowerpoint", "application/vnd.apple.mpegurl", "application/ogg", "text/css", "text/javascript", "image", "audio", "video"], ie = /\.(json|js|css|jpg|jpeg|png|svg|apng|webp|gif|bmp|mp4|mp3|mpeg|wav|webm|ogg|flv|m3u8|ttf|woff2|otf|eot|woff|html|htm|shtml|shtm|)$/gi, re = ["ret", "retcode", "code", "errcode"], ae = function() {
      var t = new WeakSet;
      return function(e, n) {
          if (n instanceof Error)
              return "Error.message: " + n.message + " \n  Error.stack: " + n.stack;
          if ("object" == typeof n && null !== n) {
              if (t.has(n))
                  return "[Circular " + (e || "root") + "]";
              t.add(n)
          }
          return n
      }
  }, O = function(e) {
      if ("string" == typeof e)
          return e;
      try {
          return e instanceof Error ? (JSON.stringify(e, ae(), 4) || "undefined").replace(/"/gim, "") : JSON.stringify(e, ae(), 4) || "undefined"
      } catch (e) {
          return "error happen when aegis stringify: \n " + e.message + " \n " + e.stack
      }
  }, se = function(e) {
      if ("string" == typeof e)
          return e;
      try {
          return JSON.stringify(e, ae()) || "undefined"
      } catch (e) {
          return "error happen when aegis stringify: \n " + e.message + " \n " + e.stack
      }
  }, ue = function(t, o) {
      void 0 === o && (o = 3);
      var i, r, a, s = "";
      return Array.isArray(t) ? (s += "[",
      i = t.length,
      t.forEach(function(e, n) {
          s = (s += "object" == typeof e && 1 < o ? ue(e, o - 1) : le(e)) + (n === i - 1 ? "" : ",")
      }),
      s += "]") : t instanceof Object ? (s = "{",
      r = Object.keys(t),
      a = r.length,
      r.forEach(function(e, n) {
          "object" == typeof t[e] && 1 < o ? s += '"' + e + '":' + ue(t[e], o - 1) : s += ce(e, t[e]),
          s += n === a - 1 || n < a - 1 && void 0 === t[r[n + 1]] ? "" : ","
      }),
      s += "}") : s += t,
      s
  }, ce = function(e, n) {
      var t = typeof n
        , o = "";
      return "string" == t || "object" == t ? o += '"' + e + '":"' + n + '"' : "function" == typeof n ? o += '"' + e + '":"function ' + n.name + '"' : "symbol" == typeof n ? o += '"' + e + '":"symbol"' : "number" != typeof n && "boolean" != t || (o += '"' + e + '": ' + n),
      o
  }, le = function(e) {
      var n = typeof e;
      return "" + ("undefined" == n || "symbol" == n || "function" == n ? "null" : "string" == n || "object" == n ? '"' + e + '"' : e)
  }, fe = ((o = L = L || {}).INFO_ALL = "-1",
  o.API_RESPONSE = "1",
  o.INFO = "2",
  o.ERROR = "4",
  o.PROMISE_ERROR = "8",
  o.AJAX_ERROR = "16",
  o.SCRIPT_ERROR = "32",
  o.IMAGE_ERROR = "64",
  o.CSS_ERROR = "128",
  o.CONSOLE_ERROR = "256",
  o.MEDIA_ERROR = "512",
  o.RET_ERROR = "1024",
  o.REPORT = "2048",
  o.PV = "4096",
  o.EVENT = "8192",
  o.PAGE_NOT_FOUND_ERROR = "16384",
  o.WEBSOCKET_ERROR = "32768",
  o.BRIDGE_ERROR = "65536",
  (o = R = R || {}).LOG = "log",
  o.SPEED = "speed",
  o.PERFORMANCE = "performance",
  o.OFFLINE = "offline",
  o.WHITE_LIST = "whiteList",
  o.VITALS = "vitals",
  o.PV = "pv",
  o.CUSTOM_PV = "customPV",
  o.EVENT = "event",
  o.CUSTOM = "custom",
  o.SDK_ERROR = "sdkError",
  o.SET_DATA = "setData",
  o.LOAD_PACKAGE = "loadPackage",
  (o = l = l || {}).production = "production",
  o.development = "development",
  o.gray = "gray",
  o.pre = "pre",
  o.daily = "daily",
  o.local = "local",
  o.test = "test",
  o.others = "others",
  function(e) {
      return e.filter(function(t, o) {
          return "static" !== t.type || !e.find(function(e, n) {
              return t.url === e.url && 200 === t.status && o < n
          })
      })
  }
  ), de = function(e) {
      e.level === L.INFO_ALL && (e.level = L.INFO)
  }, pe = function(e) {
      return (Array.isArray(e) ? e : [e]).map(function(t) {
          return Object.getOwnPropertyNames(t).reduce(function(e, n) {
              return "ctx" !== n && (e[n] = t[n]),
              e
          }, {
              level: L.INFO,
              msg: ""
          })
      })
  }, he = function(o) {
      return function(e) {
          return o.sendPipeline([function(e, t) {
              return t({
                  url: o.config.url || "",
                  data: W(pe(e)),
                  method: "post",
                  contentType: "application/json",
                  type: R.LOG,
                  log: e,
                  requestConfig: {
                      timeout: 5e3
                  },
                  success: function() {
                      var n = o.config.onReport;
                      "function" == typeof n && e.forEach(function(e) {
                          n(e)
                      }),
                      "function" == typeof t && t([])
                  }
              })
          }
          ], R.LOG)(e)
      }
  }, ge = function() {}, o = (Object.defineProperty(y.prototype, "__version__", {
      get: function() {
          return console.warn("__version__ has discard, please use version"),
          "1.38.64"
      },
      enumerable: !1,
      configurable: !0
  }),
  Object.defineProperty(y.prototype, "LogType", {
      get: function() {
          return console.warn("LogType has discard, please use logType"),
          L
      },
      enumerable: !1,
      configurable: !0
  }),
  y.prototype.init = function(e) {
      this.setConfig(e);
      for (var n = 0; n < y.installedPlugins.length; n++)
          try {
              y.installedPlugins[n].patch(this)
          } catch (e) {
              this.sendSDKError(e)
          }
      this.lifeCycle.emit("onInited")
  }
  ,
  y.prototype.setConfig = function(e) {
      Object.assign(this.config, e);
      var e = this.config
        , n = e.id
        , t = e.uin
        , o = e.version
        , i = e.ext1
        , r = e.ext2
        , a = e.ext3
        , s = e.aid
        , u = e.env
        , c = void 0 === u ? "production" : u
        , u = e.pageUrl
        , e = this.bean.id !== n || this.bean.uin !== t || this.bean.aid !== s;
      return this.bean.id = n || "",
      this.bean.uin = t || "",
      this.bean.version = o || "1.38.64",
      this.bean.aid = s || "",
      this.bean.env = function() {
          switch (c) {
          case l.production:
          case l.development:
          case l.gray:
          case l.pre:
          case l.daily:
          case l.local:
          case l.test:
          case l.others:
              return 1;
          default:
              return
          }
      }() ? c : l.others,
      u && this.extendBean("from", encodeURIComponent(u.slice(0, 2048))),
      i && this.extendBean("ext1", encodeURIComponent(i)),
      r && this.extendBean("ext2", encodeURIComponent(r)),
      a && this.extendBean("ext3", encodeURIComponent(a)),
      e && this.lifeCycle.emit("onConfigChange", this.config),
      this.config
  }
  ,
  y.use = function(e) {
      -1 === y.installedPlugins.indexOf(e) && e.aegisPlugin && y.installedPlugins.push(e)
  }
  ,
  y.unuse = function(e) {
      e = y.installedPlugins.indexOf(e);
      -1 !== e && y.installedPlugins.splice(e, 1)
  }
  ,
  y.prototype.info = function() {
      for (var e = [], n = 0; n < arguments.length; n++)
          e[n] = arguments[n];
      var t = {
          level: L.INFO,
          msg: e
      };
      1 === e.length && e[0].msg && Object.assign(t, E({}, e[0]), {
          level: L.INFO
      }),
      this.normalLogPipeline(t)
  }
  ,
  y.prototype.infoAll = function() {
      for (var e = [], n = 0; n < arguments.length; n++)
          e[n] = arguments[n];
      var t = {
          level: L.INFO_ALL,
          msg: e
      };
      1 === e.length && e[0].msg && Object.assign(t, E({}, e[0]), {
          level: L.INFO_ALL
      }),
      this.normalLogPipeline(t)
  }
  ,
  y.prototype.report = function() {
      for (var e = [], n = 0; n < arguments.length; n++)
          e[n] = arguments[n];
      var t = {
          level: L.REPORT,
          msg: e
      };
      1 === e.length && e[0].msg && Object.assign(t, E({}, e[0])),
      this.normalLogPipeline(t)
  }
  ,
  y.prototype.error = function() {
      for (var e = [], n = 0; n < arguments.length; n++)
          e[n] = arguments[n];
      var t = {
          level: L.ERROR,
          msg: e
      };
      1 === e.length && e[0].msg && Object.assign(t, E({}, e[0]), {
          level: L.ERROR
      }),
      this.normalLogPipeline(t)
  }
  ,
  y.prototype.speedLogPipeline = function(e) {
      throw new Error('You need to override "speedLogPipeline" method')
  }
  ,
  y.prototype.reportPv = function(t) {
      var o, i = this;
      t && (console.warn("reportPv is deprecated, please use reportEvent"),
      o = "" + Object.getOwnPropertyNames(this.bean).filter(function(e) {
          return "id" !== e
      }).map(function(e) {
          return e + "=" + i.bean[e]
      }).join("&"),
      this.sendPipeline([function(e, n) {
          n({
              url: i.config.url + "/" + t + "?" + o,
              addBean: !1,
              type: R.CUSTOM_PV
          })
      }
      ], R.CUSTOM_PV)(null))
  }
  ,
  y.prototype.reportEvent = function(e) {
      e && ((e = "string" == typeof e ? {
          name: e,
          ext1: this.config.ext1 || "",
          ext2: this.config.ext2 || "",
          ext3: this.config.ext3 || ""
      } : e).name ? this.eventPipeline(e) : console.warn("reportEvent params error"))
  }
  ,
  y.prototype.reportTime = function(e, n) {
      if ("object" == typeof e)
          return this.reportT(e);
      "string" == typeof e ? "number" == typeof n ? n < 0 || 6e4 < n ? console.warn("reportTime: duration must between 0 and 60000") : this.submitCustomTime(e, n) : console.warn("reportTime: second param must be number") : console.warn("reportTime: first param must be a string")
  }
  ,
  y.prototype.reportT = function(e) {
      var n = e.name
        , t = e.duration
        , o = e.ext1
        , o = void 0 === o ? "" : o
        , i = e.ext2
        , i = void 0 === i ? "" : i
        , r = e.ext3
        , r = void 0 === r ? "" : r
        , e = e.from;
      if ("string" == typeof n && "number" == typeof t && "string" == typeof o && "string" == typeof i && "string" == typeof r) {
          if (!(t < 0 || 6e4 < t))
              return this.submitCustomTime(n, t, o, i, r, void 0 === e ? "" : e);
          console.warn("reportTime: duration must between 0 and 60000")
      } else
          console.warn("reportTime: params error")
  }
  ,
  y.prototype.time = function(e) {
      "string" == typeof e ? this.timeMap[e] ? console.warn("Timer " + e + " already exists") : this.timeMap[e] = Date.now() : console.warn("time: first param must be a string")
  }
  ,
  y.prototype.timeEnd = function(e) {
      "string" == typeof e ? this.timeMap[e] ? (this.submitCustomTime(e, Date.now() - this.timeMap[e]),
      delete this.timeMap[e]) : console.warn("Timer " + e + " does not exist") : console.warn("timeEnd: first param must be a string")
  }
  ,
  y.prototype.submitCustomTime = function(e, n, t, o, i, r) {
      this.customTimePipeline({
          name: e,
          duration: n,
          ext1: t || this.config.ext1,
          ext2: o || this.config.ext2,
          ext3: i || this.config.ext3,
          from: r || void 0
      })
  }
  ,
  y.prototype.extendBean = function(e, n) {
      this.bean[e] = n
  }
  ,
  y.prototype.sendPipeline = function(e, n) {
      var t, r = this;
      return v(c([function(e, n) {
          if ("number" != typeof t.config.random && (console.warn("random must in [0, 1], default is 1."),
          t.config.random = 1),
          !t.isHidden || !t.isGetSample)
              if (t.isGetSample)
                  t.isHidden || n(e);
              else {
                  if (t.isGetSample = !0,
                  Math.random() < t.config.random)
                      return t.isHidden = !1,
                      n(e);
                  t.isHidden = !0
              }
      }
      , Q(t = this, n)], e, [Y(this), function(o, i) {
          r.request(o, function() {
              for (var e, n = [], t = 0; t < arguments.length; t++)
                  n[t] = arguments[t];
              r.failRequestCount = 0,
              i({
                  isErr: !1,
                  result: n,
                  logType: null == o ? void 0 : o.type,
                  logs: null == o ? void 0 : o.log
              }),
              null != (e = null == o ? void 0 : o.success) && e.call.apply(e, c([o], n))
          }, function() {
              for (var e, n = [], t = 0; t < arguments.length; t++)
                  n[t] = arguments[t];
              10 <= ++r.failRequestCount && r.destroy(),
              -1 < ("" + n[0]).indexOf("403 forbidden") && r.destroy(),
              i({
                  isErr: !0,
                  result: n,
                  logType: null == o ? void 0 : o.type,
                  logs: null == o ? void 0 : o.log
              }),
              null != (e = null == o ? void 0 : o.fail) && e.call.apply(e, c([o], n))
          })
      }
      , z(this)]))
  }
  ,
  y.prototype.send = function(e, i, r) {
      var n = this;
      return v([Y(this), function(t, o) {
          n.request(t, function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              o({
                  isErr: !1,
                  result: e,
                  logType: t.type,
                  logs: t.log
              }),
              null != i && i.apply(void 0, e)
          }, function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              o({
                  isErr: !0,
                  result: e,
                  logType: t.type,
                  logs: t.log
              }),
              null != r && r.apply(void 0, e)
          })
      }
      , z(this)])(e)
  }
  ,
  y.prototype.ready = function(e, n, t) {
      throw new Error('You need to override "ready" method')
  }
  ,
  y.prototype.request = function(e, n, t) {
      throw new Error('You need to override "request" method')
  }
  ,
  y.prototype.sendSDKError = function(e) {
      var t = this;
      this.sendPipeline([function(e, n) {
          n({
              url: t.config.url + "?id=1085&msg[0]=" + encodeURIComponent(O(e)) + "&level[0]=2&from=" + t.config.id + "&count=1&version=" + t.config.id + "(1.38.64)",
              addBean: !1,
              method: "get",
              type: R.SDK_ERROR,
              log: e
          })
      }
      ], R.SDK_ERROR)(e)
  }
  ,
  y.prototype.destroy = function(e) {
      void 0 === e && (e = !1);
      var n, t, o = y.instances.indexOf(this);
      -1 !== o && y.instances.splice(o, 1);
      for (var i = y.installedPlugins.length - 1; 0 <= i; i--)
          try {
              y.installedPlugins[i].unpatch(this)
          } catch (e) {
              this.sendSDKError(e)
          }
      if (this.lifeCycle.emit("destroy"),
      this.lifeCycle.clear(),
      e)
          n = this,
          t = Object.getOwnPropertyDescriptors(n),
          Object.keys(t).forEach(function(e) {
              t[e].writable && (n[e] = null)
          }),
          Object.setPrototypeOf(this, null);
      else {
          for (var r = this; r.constructor !== Object && Z(r, this),
          r = Object.getPrototypeOf(r); )
              ;
          0 === y.instances.length && (o = Object.getPrototypeOf(this).constructor,
          Z(o),
          Z(y))
      }
  }
  ,
  y.version = "1.38.64",
  y.instances = [],
  y.logType = L,
  y.environment = l,
  y.installedPlugins = [],
  y), i = (a.prototype.patch = function(e) {
      this.canUse(e) && this.exist(e) && (this.instances.push(e),
      this.triggerInit(e),
      this.triggerOnNewAegis(e))
  }
  ,
  a.prototype.unpatch = function(e) {
      var n = this.instances.indexOf(e);
      -1 !== n && (this.instances.splice(n, 1),
      0 === this.instances.length) && this.uninstall(e)
  }
  ,
  a.prototype.countInstance = function() {
      return this.instances.length
  }
  ,
  a.prototype.uninstall = function(e) {
      var n;
      null != (n = null == (n = this.option) ? void 0 : n.destroy) && n.apply(this, [e])
  }
  ,
  a.prototype.walk = function(t) {
      var o = this;
      this.instances.forEach(function(e) {
          var n = o.canUse(e);
          n && t(e, n)
      })
  }
  ,
  a.prototype.canUse = function(e) {
      e = this.getConfig(e);
      return !(!e || "object" != typeof e) || !!e
  }
  ,
  a.prototype.getConfig = function(e) {
      return null == (e = e.config) ? void 0 : e[this.name]
  }
  ,
  a.prototype.exist = function(e) {
      return -1 === this.instances.indexOf(e)
  }
  ,
  a.prototype.triggerInit = function(e) {
      var n;
      this.inited || (this.inited = !0,
      null == (n = null == (n = this.option) ? void 0 : n.init)) || n.call(this.option, this.getConfig(e))
  }
  ,
  a.prototype.triggerOnNewAegis = function(e) {
      var n;
      null != (n = null == (n = this.option) ? void 0 : n.onNewAegis) && n.call(this.option, e, this.getConfig(e))
  }
  ,
  a), me = new i({
      name: "aid",
      aid: "",
      init: function(e) {
          try {
              var n = !0 !== e && e || window.localStorage.getItem("AEGIS_ID");
              n || (n = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(e) {
                  var n = 16 * Math.random() | 0;
                  return ("x" === e ? n : 3 & n | 8).toString(16)
              }),
              window.localStorage.setItem("AEGIS_ID", n)),
              this.aid = n
          } catch (e) {}
      },
      onNewAegis: function(e) {
          e.bean.aid = this.aid,
          e.config.aid = this.aid
      }
  }), ve = ["/collect/offlineAuto", "/aegis-sdk", "/flog.core.min.js"], ye = function(n) {
      var t;
      return n.payload ? (t = {},
      Object.keys(n).forEach(function(e) {
          "payload" !== e && (t[e] = n[e])
      }),
      t) : n
  }, we = new i({
      name: "reportAssetSpeed"
  }), be = we = new i({
      name: "reportAssetSpeed",
      collectCur: 0,
      collectEntryType: "resource",
      ASSETS_INITIATOR_TYPE: ["img", "css", "script", "link", "audio", "video"],
      onNewAegis: function(e) {
          var n = this;
          ee() && (this.collectSuccessLog(e),
          this.collectFailLog(e),
          performance.onresourcetimingbufferfull = function() {
              n.collectCur = 0,
              performance.clearResourceTimings()
          }
          )
      },
      publish: function(n) {
          this.$walk(function(e) {
              e.speedLogPipeline(n)
          })
      },
      publishMany: function(e, n) {
          for (var t = n.config, o = 0, i = e.length; o < i; o++) {
              var r = e[o];
              -1 === this.ASSETS_INITIATOR_TYPE.indexOf(r.initiatorType) || te(r.name) || this.publish(this.generateLog(r, t))
          }
      },
      collectSuccessLog: function(t) {
          var e, n, o = this;
          "function" == typeof window.PerformanceObserver ? (this.publishMany(performance.getEntriesByType(this.collectEntryType), t),
          (e = new window.PerformanceObserver(function(e) {
              o.publishMany(e.getEntries(), t)
          }
          )).observe({
              entryTypes: [this.collectEntryType]
          }),
          t.lifeCycle.on("destroy", function() {
              0 === we.countInstance() && e.disconnect()
          })) : (n = setInterval(function() {
              var e = performance.getEntriesByType(o.collectEntryType)
                , n = e.slice(o.collectCur);
              o.collectCur = e.length,
              o.publishMany(n, t)
          }, 3e3),
          t.lifeCycle.on("destroy", function() {
              0 === we.countInstance() && clearInterval(n)
          }))
      },
      collectFailLog: function(e) {
          function n(e) {
              var n, t;
              e && (e = e.target || e.srcElement,
              !(n = (null == e ? void 0 : e.src) || (null == e ? void 0 : e.href)) || "string" != typeof n || -1 < window.location.href.indexOf(n) || (e = "function" == typeof (null == (e = i.api) ? void 0 : e.resourceTypeHandler) ? null == (e = i.api) ? void 0 : e.resourceTypeHandler(n) : "",
              t = performance.getEntriesByType(o.collectEntryType).find(function(e) {
                  return e.name === n
              }),
              te(n)) || (t = {
                  url: V(n),
                  status: 400,
                  duration: Number(((null == t ? void 0 : t.duration) || 0).toFixed(2)),
                  method: "get",
                  type: e || "static",
                  isHttps: G(n),
                  urlQuery: S(n, !0),
                  nextHopProtocol: "",
                  domainLookup: 0,
                  connectTime: 0
              },
              o.publish(t)))
          }
          var o = this
            , i = e.config;
          window.document.addEventListener("error", n, !0),
          e.lifeCycle.on("destroy", function() {
              0 === we.countInstance() && window.document.removeEventListener("error", n, !0)
          })
      },
      generateLog: function(e, n) {
          var t, n = "function" == typeof (null == (t = n.api) ? void 0 : t.resourceTypeHandler) ? null == (t = n.api) ? void 0 : t.resourceTypeHandler(e.name) : "";
          return {
              url: V(e.name),
              method: "get",
              duration: Number(e.duration.toFixed(2)),
              status: 200,
              type: n || "static",
              isHttps: G(e.name),
              nextHopProtocol: e.nextHopProtocol || "",
              urlQuery: S(e.name, !0),
              domainLookup: X(e.domainLookupEnd - e.domainLookupStart),
              connectTime: X(e.connectEnd - e.connectStart)
          }
      },
      collectNotReportedLog: function(e) {
          var n, t;
          ee() && (n = (t = performance.getEntriesByType(this.collectEntryType)).length,
          "function" != typeof window.PerformanceObserver) && this.collectCur !== n && (t = t.slice(this.collectCur),
          this.collectCur = n,
          this.publishMany(t, e, !0))
      },
      destroy: function() {
          this.option.publish = function() {}
      }
  }), Ee = window.navigator.userAgent.toLowerCase(), r = {};
  function a(e) {
      this.aegisPlugin = !0,
      this.name = "",
      this.instances = [],
      this.inited = !1,
      e.$walk = this.walk.bind(this),
      e.$getConfig = this.getConfig.bind(this),
      this.option = e,
      this.name = e.name
  }
  function y(e) {
      var t, n, o, i, a, r, s, u, c, l, f, d, p, h, g, m = this;
      this.isGetSample = !1,
      this.isHidden = !1,
      this.config = {
          version: 0,
          delay: 1e3,
          onError: !0,
          repeat: 5,
          random: 1,
          aid: !0,
          device: !0,
          pagePerformance: !0,
          webVitals: !0,
          speedSample: !0,
          onClose: !0,
          reportLoadPackageSpeed: !0,
          hostUrl: "https://aegis.qq.com",
          env: "production",
          url: "",
          offlineUrl: "",
          whiteListUrl: "",
          pvUrl: "",
          speedUrl: "",
          customTimeUrl: "",
          performanceUrl: "",
          webVitalsUrl: "",
          eventUrl: "",
          setDataReportUrl: "",
          reportImmediately: !0
      },
      this.isWhiteList = !1,
      this.lifeCycle = new M,
      this.bean = {},
      this.originFireUrl = "",
      this.normalLogPipeline = v([$(this, 5), K, function(e, n) {
          var o = t.config;
          n(e = e.map(function(e) {
              var n, t = o.maxLength || 102400;
              try {
                  if (!e.msg || e.msg.length <= t)
                      return e;
                  e.msg = null == (n = e.msg) ? void 0 : n.substring(0, t)
              } catch (n) {
                  e.msg = O(e.msg).substring(0, o.maxLength)
              }
              return e
          }))
      }
      , (h = (t = this).config,
      g = {},
      function(e, n) {
          var t = "number" == typeof h.repeat ? h.repeat : 5;
          if (0 === t)
              return n(e);
          n(e.filter(function(e) {
              return e.level !== L.ERROR && e.level !== L.PROMISE_ERROR && e.level !== L.AJAX_ERROR && e.level !== L.SCRIPT_ERROR && e.level !== L.IMAGE_ERROR && e.level !== L.CSS_ERROR && e.level !== L.MEDIA_ERROR || (g[e.msg] = g[e.msg] || 0,
              g[e.msg] += 1,
              !(g[e.msg] > t))
          }))
      }
      ), (d = this.lifeCycle.emit,
      p = this.config,
      function(e, n) {
          var t, o = p.logCreated;
          return "function" == typeof o ? (t = e.filter(function(e) {
              return !1 !== o(e)
          }),
          d("beforeWrite", t),
          n(t)) : (d("beforeWrite", e),
          n(e))
      }
      ), (f = this,
      setTimeout(function() {
          var e = f.config.pvUrl
            , t = void 0 === e ? "" : e
            , e = "undefined" != typeof location ? (null === location || void 0 === location ? void 0 : location.pathname) + (null === location || void 0 === location ? void 0 : location.hash) : void 0;
          t && e !== f.originFireUrl && (f.sendPipeline([function(e, n) {
              n({
                  url: t,
                  type: R.PV
              })
          }
          ], R.PV)(null),
          e) && location && (f.originFireUrl = e)
      }, 100),
      function(e, n) {
          n(e)
      }
      ), (c = u = s = !1,
      l = [],
      (a = this).lifeCycle.on("onConfigChange", function() {
          r && clearTimeout(r),
          r = setTimeout(function() {
              var e, t;
              !c && a.config && (c = !0,
              e = a.config.whiteListUrl,
              (t = void 0 === e ? "" : e) && a.sendPipeline([function(e, n) {
                  n({
                      url: t,
                      type: R.WHITE_LIST,
                      success: function(e) {
                          u = !0;
                          try {
                              var n = e.data || JSON.parse(e)
                                , t = n.retcode
                                , o = n.result
                                , i = void 0 === o ? {} : o
                                , r = (0 === t && (s = i.is_in_white_list,
                              a.isWhiteList = s,
                              0 <= i.rate) && i.rate <= 1 && (a.config.random = i.rate,
                              a.isGetSample = !1),
                              a.isWhiteList && l.length ? he(a)(l.splice(0), function() {}) : !a.isWhiteList && l.length && (l.length = 0),
                              a.config.onWhitelist);
                              "function" == typeof r && r(s)
                          } catch (e) {}
                      },
                      fail: function() {
                          u = !0
                      }
                  })
              }
              ], R.WHITE_LIST)(null),
              c = !1)
          }, a.config.uin ? 50 : 500)
      }),
      a.lifeCycle.on("destroy", function() {
          l.length = 0
      }),
      function(e, n) {
          var t;
          s || null != (t = null == (t = a.config) ? void 0 : t.api) && t.reportRequest ? n(e.concat(l.splice(0)).map(function(e) {
              return de(e),
              e
          })) : (t = e.filter(function(e) {
              return e.level !== L.INFO && e.level !== L.API_RESPONSE ? (de(e),
              !0) : (u || (l.push(e),
              200 <= l.length && (l.length = 200)),
              !1)
          })).length && n(t)
      }
      ), function(e, n) {
          try {
              var t = JSON.parse(JSON.stringify(e))
                , o = (m.lifeCycle.emit("beforeReport", t),
              m.config.beforeReport);
              (e = "function" == typeof o ? e.filter(function(e) {
                  return !1 !== o(e)
              }) : e).length && n(e)
          } catch (e) {}
      }
      , he(this)]),
      this.eventPipeline = v([$(this, 10), (i = this,
      function(e) {
          i.sendPipeline([function(e, n) {
              var t = e.map(function(e) {
                  return {
                      name: e.name,
                      ext1: e.ext1 || i.config.ext1 || "",
                      ext2: e.ext2 || i.config.ext2 || "",
                      ext3: e.ext3 || i.config.ext3 || ""
                  }
              });
              n({
                  url: i.config.eventUrl + "?payload=" + encodeURIComponent(JSON.stringify(t)),
                  type: R.EVENT,
                  log: e
              })
          }
          ], R.EVENT)(e)
      }
      )]),
      this.timeMap = {},
      this.failRequestCount = 0,
      this.customTimePipeline = v([$(this, 10), (o = this,
      function(e) {
          return o.sendPipeline([function(e, n) {
              n({
                  url: o.config.customTimeUrl + "?payload=" + encodeURIComponent(JSON.stringify({
                      custom: e
                  })),
                  type: R.CUSTOM,
                  log: e
              })
          }
          ], R.CUSTOM)(e)
      }
      )]),
      this.config = (n = this.config,
      void 0 === (e = e.hostUrl) && (e = "https://aegis.qq.com"),
      n.url = n.url || e + "/collect",
      n.offlineUrl = n.offlineUrl || e + "/offline",
      n.whiteListUrl = n.whiteListUrl || e + "/collect/whitelist",
      n.pvUrl = n.pvUrl || e + "/collect/pv",
      n.eventUrl = n.eventUrl || e + "/collect/events",
      n.speedUrl = n.speedUrl || e + "/speed",
      n.customTimeUrl = n.customTimeUrl || e + "/speed/custom",
      n.performanceUrl = n.performanceUrl || e + "/speed/performance",
      n.webVitalsUrl = n.webVitalsUrl || e + "/speed/webvitals",
      n.setDataReportUrl = n.SetDataReportUrl || e + "/speed/miniProgramData",
      n),
      y.instances.push(this)
  }
  r.macos = function() {
      return n("mac")
  }
  ,
  r.ios = function() {
      return r.iphone() || r.ipod() || r.ipad()
  }
  ,
  r.iphone = function() {
      return !r.windows() && n("iphone")
  }
  ,
  r.ipod = function() {
      return n("ipod")
  }
  ,
  r.ipad = function() {
      var e = "MacIntel" === navigator.platform && 1 < navigator.maxTouchPoints;
      return n("ipad") || e
  }
  ,
  r.android = function() {
      return !r.windows() && n("android")
  }
  ,
  r.androidPhone = function() {
      return r.android() && n("mobile")
  }
  ,
  r.androidTablet = function() {
      return r.android() && !n("mobile")
  }
  ,
  r.blackberry = function() {
      return n("blackberry") || n("bb10")
  }
  ,
  r.blackberryPhone = function() {
      return r.blackberry() && !n("tablet")
  }
  ,
  r.blackberryTablet = function() {
      return r.blackberry() && n("tablet")
  }
  ,
  r.windows = function() {
      return n("windows")
  }
  ,
  r.windowsPhone = function() {
      return r.windows() && n("phone")
  }
  ,
  r.windowsTablet = function() {
      return r.windows() && n("touch") && !r.windowsPhone()
  }
  ,
  r.fxos = function() {
      return (n("(mobile") || n("(tablet")) && n(" rv:")
  }
  ,
  r.fxosPhone = function() {
      return r.fxos() && n("mobile")
  }
  ,
  r.fxosTablet = function() {
      return r.fxos() && n("tablet")
  }
  ,
  r.meego = function() {
      return n("meego")
  }
  ,
  r.cordova = function() {
      return window.cordova && "file:" === location.protocol
  }
  ,
  r.nodeWebkit = function() {
      return "object" == typeof window.process
  }
  ,
  r.mobile = function() {
      return r.androidPhone() || r.iphone() || r.ipod() || r.windowsPhone() || r.blackberryPhone() || r.fxosPhone() || r.meego()
  }
  ,
  r.tablet = function() {
      return r.ipad() || r.androidTablet() || r.blackberryTablet() || r.windowsTablet() || r.fxosTablet()
  }
  ,
  r.desktop = function() {
      return !r.tablet() && !r.mobile()
  }
  ;
  function x(o, e, i) {
      return null != e && e.length && "object" == typeof o ? e.reduce(function(e, n) {
          var t = o instanceof Headers ? o.get(n) : o[n];
          return t ? e + ("" === e ? "\n" : "\n\n") + i + " header " + n + ": " + t : e
      }, "") : ""
  }
  function Re(e) {
      var n, t = "";
      return t = "object" == typeof e && (n = (e = function(e, n) {
          for (var t = 0; t < n.length; t++) {
              var o = n[t]
                , i = e[o] || "function" == typeof e.get && e.get(o);
              if (i)
                  return [o, i]
          }
          return ["", ""]
      }(e, Object.keys(Ae)))[0],
      e = e[1],
      n) ? Ae[n](e) : t
  }
  var Oe, Pe, Se, Te, s, Le, xe, Ce = !(r.isIE = function() {
      return "ActiveXObject"in window
  }
  ), u = [], ke = /^\/[^/]/, Ie = !1, f = [], Ae = {
      sw8: function(e) {
          e = e.split("-")[1];
          return e ? atob(e) : ""
      },
      traceparent: function(e) {
          return e.split("-")[1]
      },
      "sentry-trace": function(e) {
          return e.split("-")[0]
      }
  }, Ne = (new i({
      name: "reportApiSpeed"
  }),
  new i({
      name: "reportApiSpeed",
      override: !1,
      onNewAegis: function(e) {
          this.override || (this.override = !0,
          this.overrideFetch(e.config),
          this.overrideXhr(e.config))
      },
      getRequestType: function(e, n, t) {
          void 0 === n && (n = "");
          var o, i, e = "function" == typeof (null == (i = e.api) ? void 0 : i.resourceTypeHandler) ? null == (i = e.api) ? void 0 : i.resourceTypeHandler(t) : "";
          return "fetch" === e && "static" === e || (o = void 0 === n ? "" : n,
          i = (void 0 === t ? "" : t).split("?")[0],
          e = ie.test(i) || oe.some(function(e) {
              return -1 !== String(o).indexOf(e)
          }) ? "static" : "fetch"),
          e
      },
      overrideFetch: function(m) {
          var v = this
            , e = {
              name: this.name,
              then: function(f, d, p, h) {
                  var e, g;
                  !p || m.hostUrl && -1 < p.indexOf(m.hostUrl) || (e = f.headers ? f.headers.get("content-type") : "",
                  "fetch" === (g = v.getRequestType(m, e, p)) ? f.clone().text().then(function(t) {
                      var e, o = f.status <= 0 || 400 <= f.status, n = (null == (n = m.api) ? void 0 : n.reqHeaders) || [], i = x(null == h ? void 0 : h.headers, n, "req"), n = (null == (n = m.api) ? void 0 : n.resHeaders) || [], r = x(f.headers, n, "res"), a = Re(null == h ? void 0 : h.headers), n = J(t, m.api, {
                          url: p,
                          ctx: f,
                          payload: null == h ? void 0 : h.body
                      }), s = n.code, u = n.isErr, n = null == (n = m.api) ? void 0 : n.apiDetail, c = n ? T(null == h ? void 0 : h.body, null == (e = m.api) ? void 0 : e.reqParamHandler, {
                          url: p
                      }) : "", l = n ? T(t, null == (e = m.api) ? void 0 : e.resBodyHandler, {
                          url: p,
                          ctx: f
                      }) : "";
                      setTimeout(function() {
                          var e = v.getPerformanceEntryByUrl(m, {
                              url: p,
                              duration: d,
                              type: g,
                              status: f.status || 0,
                              method: (null == h ? void 0 : h.method) || "get"
                          })
                            , n = (o ? "FETCH_ERROR: " + t + " \n\n" : "") + "fetch req url: " + p + " \n                    \nres status: " + (f.status || 0) + " \n                    \nres duration: " + e.duration + "ms \n                    \nreq method: " + ((null == h ? void 0 : h.method) || "get") + " \n                    \nres retcode: " + s + "\n                    \nreq param: " + c + "\n                    \nres data: " + l + "\n                    " + i + "\n                    " + r;
                          e.payload = null == h ? void 0 : h.body,
                          e.ret = s,
                          e.isErr = +u,
                          v.publishNormalLog({
                              msg: n,
                              level: o ? L.AJAX_ERROR : u ? L.RET_ERROR : L.API_RESPONSE,
                              code: s,
                              trace: a
                          }),
                          v.publishSpeed(e)
                      }, 0)
                  }) : setTimeout(function() {
                      var e = v.getPerformanceEntryByUrl(m, {
                          url: p,
                          duration: d,
                          type: g,
                          status: f.status || 0,
                          method: (null == h ? void 0 : h.method) || "get"
                      });
                      e.type = "static",
                      e.urlQuery = S(p, !0),
                      v.publishSpeed(e)
                  }, 0))
              },
              catch: function(n, t, o, i) {
                  var r, e, a, s, u;
                  throw !o || m.hostUrl && -1 < o.indexOf(m.hostUrl) || (r = v.getRequestType(m, "", o),
                  e = (null == (e = m.api) ? void 0 : e.reqHeaders) || [],
                  a = x(null == i ? void 0 : i.headers, e, "req"),
                  s = Re(null == i ? void 0 : i.headers),
                  u = null != (e = m.api) && e.apiDetail ? T(null == i ? void 0 : i.body, null == (e = m.api) ? void 0 : e.reqParamHandler, {
                      url: o
                  }) : "",
                  setTimeout(function() {
                      var e = v.getPerformanceEntryByUrl(m, {
                          url: o,
                          duration: t,
                          type: r,
                          status: 0,
                          method: (null == i ? void 0 : i.method) || "get"
                      })
                        , e = (v.publishSpeed(e),
                      "AJAX_ERROR: " + n + "\n                          \nreq url: " + o + "\n                          \nres status: 0\n                          \nres duration: " + e.duration + "ms\n                          \nreq method: " + ((null == i ? void 0 : i.method) || "get") + "\n                          \nreq param:" + u + "\n                          " + a);
                      v.publishNormalLog({
                          msg: e,
                          level: L.AJAX_ERROR,
                          code: -400,
                          trace: s
                      })
                  }, 0)),
                  n
              }
          }
            , n = (this.hackFetchOptions = e,
          this.hackFetchOptions);
          if (f.find(function(e) {
              return e.name === n.name
          }))
              throw new Error("name '" + n.name + "' is already in hackFetch option list");
          f.push(n),
          !Ie && window.fetch && (Ie = !0,
          Te = window.fetch,
          window.fetch = function(e, i) {
              void 0 === i && (i = {});
              var r = "string" == typeof e ? e : null == e ? void 0 : e.url;
              ke.test(r) && (r = "" + location.origin + r);
              for (var n = 0; n < f.length; n++) {
                  var t = f[n];
                  try {
                      "function" == typeof t.beforeFetch && t.beforeFetch(r, i)
                  } catch (e) {}
              }
              var a = Date.now();
              return Te(e, i).then(function(e) {
                  for (var n = e.clone(), t = 0; t < f.length; t++) {
                      var o = f[t];
                      try {
                          "function" == typeof o.then && o.then(n, Date.now() - a, r, i)
                      } catch (e) {}
                  }
                  return n
              }).catch(function(e) {
                  for (var n = 0; n < f.length; n++) {
                      var t = f[n];
                      try {
                          "function" == typeof t.catch && t.catch(e, Date.now() - a, r, i)
                      } catch (e) {}
                  }
                  throw e
              })
          }
          )
      },
      overrideXhr: function(O) {
          var n, P = this, e = {
              name: this.name,
              send: function(E, R) {
                  var n = Date.now();
                  E.addEventListener("loadend", function() {
                      var v, y, e, w, b = E.aegisUrl || "";
                      !b || O.hostUrl && -1 < b.indexOf(O.hostUrl) || (v = "",
                      (E.failType || !E.status || 400 <= E.status) && (v = E.failType || "failed"),
                      y = Date.now() - n,
                      e = E.getResponseHeader("content-type"),
                      w = P.getRequestType(O, e, b),
                      setTimeout(function() {
                          var o = P.getPerformanceEntryByUrl(O, {
                              url: b,
                              duration: y,
                              type: w,
                              status: E.status,
                              method: E.aegisMethod || "get"
                          });
                          if ("fetch" === w) {
                              var e = (null == (e = O.api) ? void 0 : e.reqHeaders) || []
                                , i = x(E.aegisXhrReqHeader, e, "req")
                                , e = (null == (e = O.api) ? void 0 : e.resHeaders) || []
                                , n = E.getAllResponseHeaders().split("\r\n").reduce(function(e, n) {
                                  n = n.split(": ");
                                  return n[0] && n[1] && (e[n[0]] = n[1]),
                                  e
                              }, {})
                                , r = x(n, e, "res")
                                , a = Re(E.aegisXhrReqHeader)
                                , e = null == (n = O.api) ? void 0 : n.apiDetail
                                , s = e ? T(R, null == (n = O.api) ? void 0 : n.reqParamHandler, {
                                  url: b
                              }) : ""
                                , u = e ? T(E.response, null == (n = O.api) ? void 0 : n.resBodyHandler, {
                                  url: b
                              }) : "";
                              try {
                                  var t, c, l, f, d = E.response, p = O.api, h = {
                                      url: b,
                                      ctx: E,
                                      payload: R
                                  }, g = function(e) {
                                      var n = e.code
                                        , e = e.isErr
                                        , t = (v ? "AJAX_ERROR: request " + v + " \n\n" : "") + "fetch req url: " + b + " \n                      \nres status: " + o.status + "\n                      \nres duration: " + o.duration + "ms\n                      \nreq method: " + o.method + "\n                      \nres retcode: " + n + "\n                      \nreq param: " + s + "\n                      \nres data: " + u + "\n                      " + i + "\n                      " + r;
                                      o.ret = n,
                                      o.isErr = +e,
                                      o.payload = R,
                                      P.publishNormalLog({
                                          msg: t,
                                          level: v ? L.AJAX_ERROR : e ? L.RET_ERROR : L.API_RESPONSE,
                                          code: n,
                                          trace: a
                                      }),
                                      P.publishSpeed(o)
                                  };
                                  try {
                                      if ("function" == typeof (null == p ? void 0 : p.retCodeHandlerAsync))
                                          return void p.retCodeHandlerAsync(d, null == h ? void 0 : h.url, null == h ? void 0 : h.ctx, function(e) {
                                              var n = e.code
                                                , e = e.isErr;
                                              null != g && g({
                                                  code: void 0 === n ? "unknown" : n,
                                                  isErr: e
                                              })
                                          });
                                      if ("function" == typeof (null == p ? void 0 : p.retCodeHandler))
                                          return void (l = (c = p.retCodeHandler(d, null == h ? void 0 : h.url, null == h ? void 0 : h.ctx, null == h ? void 0 : h.payload) || {}).code,
                                          f = c.isErr,
                                          null != g && g({
                                              code: void 0 === l ? "unknown" : l,
                                              isErr: f
                                          }));
                                      "string" == typeof d && (d = JSON.parse(d)),
                                      "function" == typeof (null == (t = null == p ? void 0 : p.ret) ? void 0 : t.join) && (re = [].concat(p.ret.map(function(e) {
                                          return e.toLowerCase()
                                      })));
                                      var m = Object.getOwnPropertyNames(d).filter(function(e) {
                                          return -1 !== re.indexOf(e.toLowerCase())
                                      });
                                      if (m.length)
                                          return void (l = d[m[0]],
                                          null != g && g({
                                              code: "" + l,
                                              isErr: 0 !== l && "0" !== l
                                          }));
                                      null != g && g({
                                          code: "unknown",
                                          isErr: !1
                                      })
                                  } catch (d) {
                                      null != g && g({
                                          code: "unknown",
                                          isErr: !1
                                      })
                                  }
                              } catch (e) {
                                  o.ret = "unknown",
                                  P.publishSpeed(o)
                              }
                          } else
                              o.type = "static",
                              o.urlQuery = S(b, !0),
                              P.publishSpeed(o)
                      }, 0))
                  }),
                  E.addEventListener("timeout", function() {
                      E.failType = "timeout"
                  }),
                  E.addEventListener("error", function() {
                      E.failType = "error"
                  }),
                  E.addEventListener("abort", function() {
                      E.failType = "abort"
                  })
              }
          };
          this.hackXHROptions = e,
          n = this.hackXHROptions,
          u.find(function(e) {
              return e.name === n.name
          }) || (u.push(n),
          !Ce && window.XMLHttpRequest && (Oe = window.XMLHttpRequest.prototype.send,
          Pe = window.XMLHttpRequest.prototype.open,
          Se = window.XMLHttpRequest.prototype.setRequestHeader,
          Ce = !0,
          window.XMLHttpRequest.prototype.open = function() {
              this.aegisMethod = arguments[0];
              var e = arguments[1];
              if (ke.test(e) && (e = "" + location.origin + e),
              this.aegisUrl = e,
              this.aegisXhrStartTime = Date.now(),
              this.sendByAegis)
                  r.isIE() || (this.timeout = 5e3);
              else
                  for (var n = 0; n < u.length; n++) {
                      var t = u[n];
                      try {
                          "function" == typeof t.open && t.open(this)
                      } catch (e) {}
                  }
              return Pe.apply(this, arguments)
          }
          ,
          window.XMLHttpRequest.prototype.setRequestHeader = function() {
              var e = arguments[0]
                , n = arguments[1];
              return this.aegisXhrReqHeader = this.aegisXhrReqHeader || {},
              this.aegisXhrReqHeader[e] = n,
              Se.apply(this, arguments)
          }
          ,
          window.XMLHttpRequest.prototype.send = function() {
              if (!this.sendByAegis)
                  for (var e = 0; e < u.length; e++) {
                      var n = u[e];
                      try {
                          "function" == typeof n.send && n.send(this, arguments[0])
                      } catch (e) {}
                  }
              return Oe.apply(this, arguments)
          }
          ))
      },
      getPerformanceEntryByUrl: function(e, n) {
          if (null != (e = e.api) && e.usePerformanceTiming && "string" == typeof n.url) {
              e = null == (e = performance.getEntriesByName(n.url)) ? void 0 : e.pop();
              if (e)
                  return {
                      url: n.url,
                      isHttps: G(n.url),
                      method: n.method,
                      type: n.type,
                      status: n.status,
                      duration: Number(e.duration.toFixed(2)),
                      nextHopProtocol: e.nextHopProtocol || "",
                      domainLookup: X(e.domainLookupEnd - e.domainLookupStart),
                      connectTime: X(e.connectEnd - e.connectStart)
                  }
          }
          return {
              url: n.url,
              isHttps: G(n.url),
              method: n.method,
              type: n.type,
              status: n.status,
              duration: Number(n.duration.toFixed(2)),
              nextHopProtocol: "",
              domainLookup: t.number,
              connectTime: t.number
          }
      },
      publishSpeed: function(t) {
          var o = this;
          this.$walk(function(e) {
              var n = o.$getConfig(e);
              "fetch" === t.type && n && "function" == typeof n.urlHandler ? e.speedLogPipeline(E(E({}, t), {
                  url: S(n.urlHandler(t.url, t.payload))
              })) : (t.url = S(t.url),
              e.speedLogPipeline(t))
          })
      },
      publishNormalLog: function(n) {
          this.$walk(function(e) {
              e.normalLogPipeline(n)
          })
      },
      destroy: function() {
          var n, t, e;
          this.option.publishSpeed = function() {}
          ,
          this.option.publishNormalLog = function() {}
          ,
          this.option.hackXHROptions && (n = this.option.hackXHROptions,
          -1 !== (e = u.findIndex(function(e) {
              return e.name === n.name
          })) && u.splice(e, 1),
          window.XMLHttpRequest.prototype.send = Oe,
          window.XMLHttpRequest.prototype.open = Pe,
          window.XMLHttpRequest.prototype.setRequestHeader = Se,
          Ce = !1),
          this.option.hackFetchOptions && (t = this.option.hackFetchOptions,
          -1 !== (e = f.findIndex(function(e) {
              return e.name === t.name
          })) && f.splice(e, 1),
          window.fetch = Te,
          Ie = !1),
          this.option.override = !1
      }
  })), d = {}, Ue = new i({
      name: "reportBridgeSpeed",
      override: !1,
      onNewAegis: function(e) {
          this.override || (this.override = !0,
          this.overrideBridge(e))
      },
      publishSpeed: function(n) {
          this.$walk(function(e) {
              e.speedLogPipeline(n)
          })
      },
      overrideBridge: function(e) {
          var u = this
            , c = e.config;
          c.reportBridgeSpeed && c.h5Bridge && c.h5BridgeFunc.length && c.h5BridgeFunc.forEach(function(e) {
              var s = c.h5Bridge[e];
              d[e] = s,
              c.h5Bridge[e] = function() {
                  for (var e = [], n = 0; n < arguments.length; n++)
                      e[n] = arguments[n];
                  var o = e[0]
                    , i = e[1]
                    , t = e[2]
                    , r = e[3]
                    , a = Date.now();
                  s(o, i, t, function(e) {
                      var n = J(e, c.api)
                        , t = n.code
                        , n = n.isErr
                        , t = {
                          url: o + "-" + i,
                          name: o + "-" + i,
                          duration: Date.now() - a,
                          type: "bridge",
                          ret: t,
                          isErr: +n
                      };
                      u.publishSpeed(t),
                      r(e)
                  })
              }
          })
      },
      unHackBridge: function(n) {
          Object.keys(d).forEach(function(e) {
              d[e] && (n.config.h5Bridge[e] = d[e])
          }),
          d = {}
      },
      destroy: function(e) {
          this.option.publishSpeed = function() {}
          ,
          this.option.unHackBridge(e),
          this.option.override = !1
      }
  });
  (b = s = s || {})[b.unknown = 100] = "unknown",
  b[b.wifi = 1] = "wifi",
  b[b.net2g = 2] = "net2g",
  b[b.net3g = 3] = "net3g",
  b[b.net4g = 4] = "net4g",
  b[b.net5g = 5] = "net5g",
  b[b.net6g = 6] = "net6g",
  (b = Le = Le || {})[b.android = 1] = "android",
  b[b.ios = 2] = "ios",
  b[b.windows = 3] = "windows",
  b[b.macos = 4] = "macos",
  b[b.linux = 5] = "linux",
  b[b.other = 100] = "other",
  (b = xe = xe || {})[b.unknown = 100] = "unknown",
  b[b.normal = 0] = "normal",
  b[b.weak = 1] = "weak",
  b[b.disconnected = 2] = "disconnected";
  function p(e, n, t, o) {
      return void 0 === t && (t = 3e4),
      void 0 === o && (o = 0),
      (n = void 0 === n ? 0 : n) <= e && e <= t ? e : o
  }
  var h, g, m, _e, je, w, qe, He, Fe, b = new i({
      name: "device",
      onNewAegis: function(e) {
          e.extendBean("platform", this.getPlatform()),
          e.extendBean("netType", s.unknown),
          this.getDpi(e),
          this.refreshNetworkTypeToBean(e),
          this.refreshNetworkStatusToBean(e)
      },
      getDpi: function(e) {
          e.extendBean("vp", Math.round(window.innerWidth) + " * " + Math.round(window.innerHeight)),
          window.screen && e.extendBean("sr", Math.round(window.screen.width) + " * " + Math.round(window.screen.height))
      },
      getPlatform: function() {
          var n = {
              android: /\bAndroid\s*([^;]+)/,
              ios: /\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,
              windows: /\b(Windows NT)/,
              macos: /\b(Mac OS)/,
              linux: /\b(Linux)/i
          }
            , e = Object.keys(n).find(function(e) {
              return n[e].test(navigator.userAgent)
          });
          return e ? Le[e] : Le.other
      },
      refreshNetworkTypeToBean: function(n) {
          var t = this
            , e = n.config;
          e && ("function" == typeof e.getNetworkType ? e.getNetworkType : Be)(function(e) {
              s[e] || (e = s.unknown),
              n.extendBean("netType", e),
              t.NetworkRefreshTimer = setTimeout(function() {
                  t.refreshNetworkTypeToBean(n),
                  clearTimeout(t.NetworkRefreshTimer)
              }, 1e4)
          })
      },
      refreshNetworkStatusToBean: function(n) {
          var e, t = this, o = n.config;
          o && null != (e = "function" == typeof o.getNetworkStatus ? o.getNetworkStatus : e) && e(function(e) {
              void 0 === xe[e] && (e = xe.unknown),
              n.extendBean("netStatus", e),
              t.NetworkStatusRefreshTimer = setTimeout(function() {
                  t.refreshNetworkStatusToBean(n),
                  clearTimeout(t.NetworkStatusRefreshTimer)
              }, 1e4)
          })
      }
  }), Be = function(e) {
      var n = ""
        , t = navigator.userAgent.match(/NetType\/(\w+)/);
      t ? n = t[1] : navigator.connection && (n = navigator.connection.effectiveType || navigator.connection.type),
      e((t = n = n || "unknown",
      0 <= (t = String(t).toLowerCase()).indexOf("4g") ? s.net4g : 0 <= t.indexOf("wifi") ? s.wifi : 0 <= t.indexOf("5g") ? s.net5g : 0 <= t.indexOf("6g") ? s.net6g : 0 <= t.indexOf("3g") ? s.net3g : 0 <= t.indexOf("2g") ? s.net2g : s.unknown))
  }, De = window.WebSocket, P = [], Me = {
      construct: function(e, n) {
          var a = new e(n[0],n[1]);
          return a.originSend = a.send,
          a.addEventListener("error", function(e) {
              var e = (null == e ? void 0 : e.currentTarget) || {}
                , n = e.url
                , t = e.readyState;
              null != P && P.forEach(function(e) {
                  e = e.onErr;
                  null != e && e({
                      msg: "",
                      readyState: t,
                      connectUrl: n
                  })
              })
          }),
          Object.defineProperty(a, "send", {
              get: function() {
                  return function(e) {
                      null != (n = a.originSend) && n.call(a, e);
                      var n = a.readyState
                        , e = WebSocket.OPEN
                        , t = WebSocket.CLOSED
                        , o = WebSocket.CONNECTING
                        , i = WebSocket.CLOSING;
                      if (n !== e) {
                          var r = {
                              readyState: n,
                              connectUrl: a.url
                          };
                          switch (n) {
                          case t:
                              P.forEach(function(e) {
                                  e = e.sendErr;
                                  null != e && e(E({
                                      msg: ""
                                  }, r))
                              });
                              break;
                          case o:
                              P.forEach(function(e) {
                                  (0,
                                  e.sendErr)(E({
                                      msg: ""
                                  }, r))
                              });
                              break;
                          case i:
                              P.forEach(function(e) {
                                  (0,
                                  e.sendErr)(E({
                                      msg: ""
                                  }, r))
                              })
                          }
                      }
                  }
              }
          }),
          a
      }
  }, We = /data:(image|text)\/.*;base64/, Xe = new i({
      name: "onError"
  }), Ve = Xe = new i({
      name: "onError",
      onNewAegis: function(e) {
          this.startListen(e)
      },
      startListen: function(i) {
          function e(e) {
              (e = e && O(e.reason)) && s.publishErrorLog({
                  msg: "PROMISE_ERROR: " + e,
                  level: L.PROMISE_ERROR
              })
          }
          function n(e) {
              var n;
              if (e = (null == e ? void 0 : e.target) || (null == e ? void 0 : e.srcElement)) {
                  var t = e.src || e.href || ""
                    , e = e.tagName
                    , e = void 0 === e ? "script" : e;
                  if (!("string" != typeof (n = t) || !n || -1 < window.location.href.indexOf(n) || We.test(n) || i.config.hostUrl && -1 < n.indexOf(i.config.hostUrl))) {
                      var o = {
                          msg: e + " load fail: " + t,
                          level: L.INFO
                      };
                      if (/\.js$/.test(t))
                          o.level = L.SCRIPT_ERROR;
                      else if (/\.css$/.test(t))
                          o.level = L.CSS_ERROR;
                      else
                          switch (e.toLowerCase()) {
                          case "script":
                              o.level = L.SCRIPT_ERROR;
                              break;
                          case "link":
                              o.level = L.CSS_ERROR;
                              break;
                          case "img":
                              o.level = L.IMAGE_ERROR;
                              break;
                          case "audio":
                          case "video":
                              o.level = L.MEDIA_ERROR;
                              break;
                          default:
                              return
                          }
                      s.publishErrorLog(o)
                  }
              }
          }
          var t, o, r, a, s = this, u = window.onerror;
          window.onerror = function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              s.publishErrorLog({
                  msg: (O(e[0]) || "") + " @ (" + (O(e[1]) || "") + ":" + (e[2] || 0) + ":" + (e[3] || 0) + ")\n          \n" + O(e[4] || ""),
                  level: L.ERROR
              }),
              null != u && u.call.apply(u, c([window], e))
          }
          ,
          window.addEventListener("unhandledrejection", e);
          window.document.addEventListener("error", n, !0),
          i.lifeCycle.on("destroy", function() {
              0 === Xe.countInstance() && (window.document.removeEventListener("unhandledrejection", e),
              window.document.removeEventListener("error", n, !0))
          }),
          i.config.websocketHack && (t = {
              key: i.config.id + "-" + this.name,
              onErr: function(e) {
                  var n;
                  null != (n = s.publishWsErrorLog) && n.call(s, e)
              },
              sendErr: function(e) {
                  var n;
                  null != (n = s.publishWsErrorLog) && n.call(s, e)
              }
          },
          this.hackWebsocketConfig = t,
          t = this.hackWebsocketConfig,
          window.Proxy) && window.WebSocket && (o = window.WebSocket,
          window && !o.isHack && (r = new Proxy(WebSocket,Me),
          o.isHack = !0,
          window.WebSocket = r),
          a = t,
          P.find(function(e) {
              return e.key === a.key
          }) || a && P.push(a))
      },
      publishErrorLog: function(n) {
          this.$walk(function(e) {
              e.normalLogPipeline(n)
          })
      },
      publishWsErrorLog: function(e) {
          var n = e.connectUrl
            , t = e.msg
            , e = e.readyState;
          this.publishErrorLog({
              msg: "WEBSOCKET_ERROR: \n              connect: " + n + "\n              readyState: " + e + "\n              msg: " + t,
              level: L.WEBSOCKET_ERROR
          })
      },
      destroy: function() {
          var n, e;
          this.option.publishErrorLog = function() {}
          ,
          this.option.hackWebsocketConfig && (n = this.option.hackWebsocketConfig,
          window.WebSocket = De,
          -1 !== (e = P.findIndex(function(e) {
              return e.key === n.key
          }))) && P.splice(e, 1)
      }
  }), Ge = (new i({
      name: "pagePerformance"
  }),
  3), Je = new i({
      name: "pagePerformance",
      onNewAegis: function(e) {
          ee() && (h ? this.publish(h, e) : this.startCalcPerformance(e))
      },
      publish: function(e, a) {
          var s = this;
          a.sendPipeline([function(e, n) {
              var t, o = [];
              for (t in e)
                  o.push(t + "=" + e[t]);
              var i, r = s.$getConfig(a);
              if (r)
                  return i = -1 === a.config.performanceUrl.indexOf("?") ? "?" : "&",
                  "function" == typeof r.urlHandler ? n({
                      url: a.config.performanceUrl + i + o.join("&") + "&from=" + (encodeURIComponent(r.urlHandler()) || window.location.href),
                      beanFilter: ["from"],
                      type: R.PERFORMANCE,
                      log: e
                  }) : n({
                      url: a.config.performanceUrl + i + o.join("&"),
                      type: R.PERFORMANCE,
                      log: e
                  })
          }
          ], R.PERFORMANCE)(e)
      },
      startCalcPerformance: function(t) {
          var o = this;
          try {
              this.getFirstScreenTiming(t, function(e) {
                  var n = performance.timing;
                  n && (h = {
                      dnsLookup: p(n.domainLookupEnd - n.domainLookupStart),
                      tcp: p(n.connectEnd - n.connectStart),
                      ssl: p(0 === n.secureConnectionStart ? 0 : n.requestStart - n.secureConnectionStart),
                      ttfb: p(n.responseStart - n.requestStart),
                      contentDownload: p(n.responseEnd - n.responseStart),
                      domParse: p(n.domInteractive - n.domLoading, 0, 3e4, 1070),
                      resourceDownload: p(n.loadEventStart - n.domInteractive, 0, 3e4, 1070),
                      firstScreenTiming: p(Math.floor(e), 0, 6e4)
                  },
                  (n = t.config).extraPerformanceData && "{}" !== JSON.stringify(n.extraPerformanceData) && (n = (e = n.extraPerformanceData).engineInit,
                  e = e.bundleLoad,
                  h = E(E({}, h), {
                      engineInit: p(n, 0, 1e4),
                      bundleLoad: p(e, 0, 1e4)
                  })),
                  o.publish(h, t))
              })
          } catch (t) {}
      },
      getFirstScreenTiming: function(s, u) {
          s.lifeCycle.on("destroy", function() {
              h && clearTimeout(h)
          });
          var c = this
            , t = ["script", "style", "link", "br"]
            , l = []
            , f = {}
            , d = new MutationObserver(function(e) {
              var n = {
                  roots: [],
                  rootsDomNum: [],
                  time: performance.now()
              };
              e.forEach(function(e) {
                  e && e.addedNodes && e.addedNodes.forEach && e.addedNodes.forEach(function(e) {
                      1 === e.nodeType && e.hasAttribute("AEGIS-FIRST-SCREEN-TIMING") ? (Object.prototype.hasOwnProperty.apply(f, [n.time]) || (f[n.time] = []),
                      f[n.time].push(e)) : 1 !== e.nodeType || -1 !== t.indexOf(e.nodeName.toLocaleLowerCase()) || c.isEleInArray(e, n.roots) || e.hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING") || (n.roots.push(e),
                      n.rootsDomNum.push(c.walkAndCount(e) || 0))
                  })
              }),
              n.roots.length && l.push(n)
          }
          )
            , p = (d.observe(document, {
              childList: !0,
              subtree: !0
          }),
          function(o) {
              (o = void 0 === o ? 0 : o) || (i = 0,
              (e = Object.keys(f)).length ? (o = Math.max.apply(null, e),
              ("object" != typeof (null == (e = s.config) ? void 0 : e.pagePerformance) || null != (e = s.config.pagePerformance) && e.firstScreenInfo) && (s.firstScreenInfo = {
                  element: null == (e = f[o]) ? void 0 : e[0],
                  timing: o,
                  markDoms: f
              })) : l.forEach(function(e) {
                  for (var n, t = 0; t < e.roots.length; t++)
                      e.rootsDomNum[t] > i && c.isInFirstScreen(e.roots[t]) && (i = e.rootsDomNum[t],
                      o = e.time,
                      "object" != typeof (null == (n = s.config) ? void 0 : n.pagePerformance) || null != (n = s.config.pagePerformance) && n.firstScreenInfo) && (s.firstScreenInfo = {
                          element: e.roots[t],
                          timing: o
                      })
              }),
              l.length = 0,
              Object.keys(f).forEach(function(e) {
                  f[e] = f[e].map(function(e) {
                      var n = {
                          tagName: e.tagName
                      }
                        , t = e.attributes;
                      if (!t)
                          return e;
                      for (var o = 0; o < t.length; o++) {
                          var i = t[o];
                          i.name && (n[i.name] = e.getAttribute(i.name))
                      }
                      return n
                  })
              }));
              var i, e = performance.timing, n = e.domInteractive - e.domLoading, e = e.loadEventStart - e.domInteractive, t = o;
              h = null;
              for (var r = 0, a = [n, e, t]; r < a.length; r++)
                  if (a[r] <= 0 && 0 < Ge) {
                      h = setTimeout(function() {
                          return p(t)
                      }, 3e3);
                      break
                  }
              h ? --Ge : (d.disconnect(),
              null != u && u(o))
          }
          )
            , h = setTimeout(function() {
              return p()
          }, 3e3)
      },
      isEleInArray: function(e, n) {
          return !(!e || e === document.documentElement) && (-1 !== n.indexOf(e) || this.isEleInArray(e.parentElement, n))
      },
      isInFirstScreen: function(e) {
          var n, t;
          return !(!e || "function" != typeof e.getBoundingClientRect) && (e = e.getBoundingClientRect(),
          n = window.innerHeight,
          t = window.innerWidth,
          0 <= e.left) && e.left < t && 0 <= e.top && e.top < n && 0 < e.width && 0 < e.height
      },
      walkAndCount: function(e) {
          var n = 0;
          if (e && 1 === e.nodeType) {
              n += 1;
              var t = e.children;
              if (null != t && t.length)
                  for (var o = 0; o < t.length; o++)
                      n += this.walkAndCount(t[o])
          }
          return n
      }
  });
  function $e() {
      je = [],
      m = -1,
      g = null,
      Ye(addEventListener)
  }
  function Ke(e, n) {
      g || (g = n,
      m = e,
      _e = new Date,
      Ye(removeEventListener),
      Qe())
  }
  function Qe() {
      var n;
      0 <= m && m < _e - qe && (n = {
          entryType: "first-input",
          name: g.type,
          target: g.target,
          cancelable: g.cancelable,
          startTime: g.timeStamp,
          processingStart: g.timeStamp + m
      },
      je.forEach(function(e) {
          e(n)
      }),
      je = [])
  }
  function Ye(n) {
      ["mousedown", "keydown", "touchstart", "pointerdown"].forEach(function(e) {
          return n(e, He, w)
      })
  }
  w = {
      passive: !0,
      capture: !0
  },
  qe = new Date,
  He = function(e) {
      var n, t, o, i;
      function r() {
          Ke(t, o),
          i()
      }
      function a() {
          i()
      }
      e.cancelable && (n = (1e12 < e.timeStamp ? new Date : performance.now()) - e.timeStamp,
      "pointerdown" == e.type ? (t = n,
      o = e,
      i = function() {
          removeEventListener("pointerup", r, w),
          removeEventListener("pointercancel", a, w)
      }
      ,
      addEventListener("pointerup", r, w),
      addEventListener("pointercancel", a, w)) : Ke(n, e))
  }
  ,
  Fe = "hidden" === document.visibilityState ? 0 : 1 / 0,
  addEventListener("visibilitychange", function e(n) {
      "hidden" === document.visibilityState && (Fe = n.timeStamp,
      removeEventListener("visibilitychange", e, !0))
  }, !0),
  $e(),
  self.webVitals = {
      firstInputPolyfill: function(e) {
          je.push(e),
          Qe()
      },
      resetFirstInputPolyfill: $e,
      get firstHiddenTime() {
          return Fe
      }
  };
  function C(e, n) {
      return {
          name: e,
          value: void 0 === n ? -1 : n,
          delta: 0,
          entries: [],
          id: "v1-".concat(Date.now(), "-").concat(Math.floor(8999999999999 * Math.random()) + 1e12)
      }
  }
  function ze(e, n) {
      try {
          var t;
          if (PerformanceObserver.supportedEntryTypes.includes(e))
              if ("first-input" !== e || "PerformanceEventTiming"in self)
                  return (t = new PerformanceObserver(function(e) {
                      return e.getEntries().map(n)
                  }
                  )).observe({
                      type: e,
                      buffered: !0
                  }),
                  t
      } catch (e) {}
  }
  function k(n) {
      addEventListener("pageshow", function(e) {
          e.persisted && n(e)
      }, !0)
  }
  function I(e, n, t) {
      var o;
      return function() {
          0 <= n.value && (t || A.has(n) || "hidden" === document.visibilityState) && (n.delta = n.value - (o || 0),
          n.delta || void 0 === o) && (o = n.value,
          e(n))
      }
  }
  function Ze() {
      an(function(e) {
          e = e.timeStamp;
          N = e
      }, !0)
  }
  function en() {
      return N < 0 && ((N = self.webVitals.firstHiddenTime) === 1 / 0 && Ze(),
      k(function() {
          setTimeout(function() {
              N = "hidden" === document.visibilityState ? 0 : 1 / 0,
              Ze()
          }, 0)
      })),
      {
          get timeStamp() {
              return N
          }
      }
  }
  function nn(e) {
      var n = e.name
        , e = e.value;
      sn[n] = e
  }
  function tn(e, h) {
      function g(e) {
          b = e
      }
      function m(e) {
          y = y.concat(e)
      }
      function v(e, n) {
          w = {
              conds: e = void 0 === e ? {} : e,
              params: n = void 0 === n ? {} : n
          }
      }
      var y = []
        , w = null
        , b = null;
      U.useAsyncPlugin(e, {
          exportsConstructor: "Flog",
          onAegisInit: function(e) {
              e.lifeCycle.on("beforeWrite", m),
              e.lifeCycle.on("uploadLogs", v),
              e.lifeCycle.on("onConfigChange", g)
          },
          onAegisInitAndPluginLoaded: function(o, e) {
              var n, t, i, r, a, s, u = h.dbConfig, u = void 0 === u ? {} : u, c = h.url, c = void 0 === c ? U.urls.aegisCollect : c, l = h.offlineLogExp, l = void 0 === l ? 3 : l, f = h.id, d = h.uin, c = (null != (n = o.lifeCycle) && n.remove("beforeWrite", m),
              null != (n = o.lifeCycle) && n.remove("uploadLogs", v),
              null != (n = o.lifeCycle) && n.remove("onConfigChange", g),
              Object.assign({
                  lookupUrl: c + "/offlineAuto?id=" + f,
                  preservedDay: l,
                  id: f,
                  uin: d,
                  aid: (null == (n = o.bean) ? void 0 : n.aid) || "",
                  beforeRequest: o.config.beforeRequest,
                  afterRequest: o.config.afterRequest
              }, u, {
                  sessionId: U.sessionID
              }));
              try {
                  var p = new e(c);
                  y.forEach(function(e) {
                      p.add(E(E({}, e), {
                          level: e.level === L.INFO_ALL ? L.INFO : e.level
                      }))
                  }),
                  null != (t = o.lifeCycle) && t.on("beforeWrite", function(e) {
                      (e = void 0 === e ? [] : e).forEach(function(e) {
                          p.add(E(E({}, e), {
                              level: e.level === L.INFO_ALL ? L.INFO : e.level
                          }))
                      })
                  }),
                  null != (i = o.lifeCycle) && i.on("uploadLogs", function(e, n) {
                      var t;
                      void 0 === e && (e = {}),
                      void 0 === n && (n = {}),
                      p.uploadLogs(Object.assign({
                          id: h.id,
                          uin: h.uin,
                          aid: null == (t = o.bean) ? void 0 : t.aid
                      }, e), n)
                  }),
                  null != (r = o.lifeCycle) && r.on("onConfigChange", function(e) {
                      p.setConfig(e)
                  }),
                  null != (a = o.lifeCycle) && a.on("destroy", function() {
                      0 === ln.countInstance() && (y.length = 0,
                      "function" == typeof ((w = null) == p ? void 0 : p.destroy)) && p.destroy()
                  }),
                  p.on("PERREVENT", function(e) {
                      o.sendPipeline([function(e, n) {
                          t = {
                              msg: O(e),
                              level: L.INFO
                          };
                          var t = (t = Array.isArray(t) ? t : [t]).map(function(n, t) {
                              return Object.getOwnPropertyNames(n).map(function(e) {
                                  return B(e) + "[" + t + "]=" + (void 0 === n[e] ? "" : B(n[e]))
                              }).join("&")
                          }).join("&") + (t.length ? "&count=" + t.length : "");
                          n({
                              type: R.OFFLINE,
                              data: t,
                              contentType: "application/x-www-form-urlencoded",
                              method: "post",
                              addBean: !1,
                              url: h.url + "?id=893&sessionId=" + U.sessionID + "&uin=" + h.uin + "&from=" + h.id + "&count=1&version=1.38.64",
                              log: e
                          })
                      }
                      ], R.OFFLINE)(e)
                  }),
                  b && (p.setConfig(b),
                  b = null),
                  w && (null != (s = o.lifeCycle) && s.emit("uploadLogs", w.conds, w.params),
                  w = null),
                  o.flog = p
              } catch (o) {
                  console.log(o)
              }
          }
      })
  }
  var on, rn, an = function(n, t) {
      function o(e) {
          "pagehide" !== e.type && "hidden" !== document.visibilityState || (n(e),
          t && (removeEventListener("visibilitychange", o, !0),
          removeEventListener("pagehide", o, !0)))
      }
      addEventListener("visibilitychange", o, !0),
      addEventListener("pagehide", o, !0)
  }, A = new ("function" == typeof WeakSet ? WeakSet : Set), N = -1, sn = (new i({
      name: "webVitals"
  }),
  {
      FCP: -1,
      LCP: -1,
      FID: -1,
      CLS: -1
  }), un = new i({
      name: "webVitals",
      onNewAegis: function(e) {
          if (ee() && "function" == typeof window.PerformanceObserver && "function" == typeof performance.getEntriesByName)
              try {
                  v = nn,
                  w = en(),
                  b = C("FCP"),
                  E = performance.getEntriesByName("first-contentful-paint")[0],
                  R = E ? null : ze("paint", S),
                  (E || R) && (y = I(v, b, void 0),
                  E && S(E),
                  k(function(e) {
                      b = C("FCP"),
                      y = I(v, b, void 0),
                      requestAnimationFrame(function() {
                          requestAnimationFrame(function() {
                              b.value = performance.now() - e.timeStamp,
                              A.add(b),
                              y()
                          })
                      })
                  })),
                  f = nn,
                  h = en(),
                  g = C("LCP"),
                  (m = ze("largest-contentful-paint", P)) && (d = I(f, g, void 0),
                  p = function() {
                      A.has(g) || (m.takeRecords().map(P),
                      m.disconnect(),
                      A.add(g),
                      d())
                  }
                  ,
                  ["keydown", "click"].forEach(function(e) {
                      addEventListener(e, p, {
                          once: !0,
                          capture: !0
                      })
                  }),
                  an(p, !0),
                  k(function(e) {
                      g = C("LCP"),
                      d = I(f, g, void 0),
                      requestAnimationFrame(function() {
                          requestAnimationFrame(function() {
                              g.value = performance.now() - e.timeStamp,
                              A.add(g),
                              d()
                          })
                      })
                  })),
                  a = nn,
                  s = en(),
                  u = C("FID"),
                  c = ze("first-input", O),
                  l = I(a, u, void 0),
                  c && an(function() {
                      c.takeRecords().map(O),
                      c.disconnect()
                  }, !0),
                  c || window.webVitals.firstInputPolyfill(O),
                  k(function() {
                      u = C("FID"),
                      l = I(a, u, void 0),
                      window.webVitals.resetFirstInputPolyfill(),
                      window.webVitals.firstInputPolyfill(O)
                  }),
                  t = nn,
                  i = C("CLS", 0),
                  (r = ze("layout-shift", n)) && (o = I(t, i, void 0),
                  an(function() {
                      r.takeRecords().map(n),
                      o()
                  }),
                  k(function() {
                      i = C("CLS", 0),
                      o = I(t, i, void 0)
                  })),
                  ne(this.publish.bind(this, e), !0)
              } catch (e) {}
          function n(e) {
              e.hadRecentInput || (i.value += e.value,
              i.entries.push(e),
              o())
          }
          var t, o, i, r, a, s, u, c, l, f, d, p, h, g, m, v, y, w, b, E, R;
          function O(e) {
              e.startTime < s.timeStamp && (u.value = e.processingStart - e.startTime,
              u.entries.push(e),
              A.add(u),
              l())
          }
          function P(e) {
              var n = e.startTime;
              n < h.timeStamp && (g.value = n,
              g.entries.push(e)),
              d()
          }
          function S(e) {
              "first-contentful-paint" === e.name && (R && R.disconnect(),
              e.startTime < w.timeStamp) && (b.value = e.startTime,
              b.entries.push(e),
              A.add(b),
              y())
          }
      },
      publish: function(r) {
          var e;
          null != (e = r.sendPipeline) && e.call(r, [function(e, n) {
              var t, o = [];
              for (t in e)
                  o.push(t + "=" + e[t]);
              var i = -1 === r.config.performanceUrl.indexOf("?") ? "?" : "&";
              n({
                  url: r.config.webVitalsUrl + i + o.join("&"),
                  type: R.VITALS,
                  log: e,
                  sendBeacon: !0
              })
          }
          ], R.VITALS)(sn)
      },
      destroy: function() {
          this.option.publish = function() {}
      }
  }), cn = 0, U = (F(rn = _, o = on = o),
  rn.prototype = null === o ? Object.create(o) : (dn.prototype = o.prototype,
  new dn),
  _.prototype.getBean = function(n) {
      var t = this;
      return void 0 === n && (n = []),
      "" + Object.getOwnPropertyNames(this.bean).filter(function(e) {
          return -1 === n.indexOf(e)
      }).map(function(e) {
          return "from" === e ? "from=" + t.getCurrentPageUrl() : e + "=" + t.bean[e]
      }).join("&")
  }
  ,
  _.prototype.getCurrentPageUrl = function() {
      var e = this.config.pageUrl || location.href
        , e = (e = "function" == typeof this.config.urlHandler ? this.config.urlHandler() : e).slice(0, 2048);
      return encodeURIComponent(e)
  }
  ,
  _.prototype.ready = function() {
      function r() {
          var e, t, o, i;
          n.reportRequestQueue.length && (e = n.reportRequestQueue.splice(0, 1)[0],
          t = e.options,
          o = e.success,
          i = e.fail,
          n.$request(t, function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              try {
                  return null == o ? void 0 : o.apply(t, e)
              } finally {
                  r()
              }
          }, function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              try {
                  return null == i ? void 0 : i.apply(t, e)
              } finally {
                  r()
              }
          }))
      }
      var n = this;
      r(),
      this.isReportReady = !0
  }
  ,
  _.prototype.request = function(e, n, t) {
      this.config.reportImmediately || this.isReportReady ? this.$request(e, n, t) : this.reportRequestQueue.push({
          options: e,
          success: n,
          fail: t
      })
  }
  ,
  _.prototype.$request = function(e, n, t) {
      var o, i, r, a;
      if (e && "string" == typeof e.url && "" !== e.url && this.bean.id)
          return a = e.url,
          !1 !== e.addBean && (a = a + (-1 === a.indexOf("?") ? "?" : "&") + this.getBean(e.beanFilter)),
          e.url = a,
          a = e.method || "get",
          (e = (i = this.config.onBeforeRequest) ? i(e, this) : e) ? e.url ? void ((null != e && e.sendBeacon || this.sendNow) && "function" == typeof (null === navigator || void 0 === navigator ? void 0 : navigator.sendBeacon) ? navigator.sendBeacon(e.url, e.data) : ((o = new XMLHttpRequest).sendByAegis = !0,
          o.addEventListener("readystatechange", function() {
              4 === o.readyState && (400 <= o.status || 0 === o.status ? null != t && t(o.response) : null != n && n(o.response))
          }),
          "get" === a.toLocaleLowerCase() ? (o.open("get", (i = e.url,
          r = e.data,
          "string" != typeof i ? "" : "object" == typeof r && r ? (a = Object.getOwnPropertyNames(r).map(function(e) {
              var n = r[e];
              return e + "=" + ("string" == typeof n ? encodeURIComponent(n) : encodeURIComponent(JSON.stringify(n)))
          }).join("&").replace(/eval/gi, "evaI"),
          i + (-1 === i.indexOf("?") ? "?" : "&") + a) : i)),
          o.send()) : (o.open("post", e.url),
          e.contentType && o.setRequestHeader("Content-Type", e.contentType),
          "string" == typeof e.data && (e.data = e.data.replace(/eval/gi, "evaI")),
          o.send(e.data)))) : console.warn("Please handle the parameters reasonably, options.url is necessary") : console.warn("Sending request blocked")
  }
  ,
  _.useAsyncPlugin = function(a, e) {
      var n = (e = void 0 === e ? {} : e).exportsConstructor
        , s = void 0 === n ? "aegis-plugin-" + cn : n
        , n = e.onAegisInit
        , u = void 0 === n ? function() {}
      : n
        , n = e.onAegisInitAndPluginLoaded
        , c = void 0 === n ? function() {}
      : n;
      if (cn += 1,
      "string" != typeof a)
          throw new TypeError("useAsyncPlugin first param must be string");
      if ("function" != typeof u || "function" != typeof c)
          throw new TypeError("onAegisInit and onAegisInitAndPluginLoaded must be function");
      this.use(new i({
          name: "asyncPlugin",
          onNewAegis: function(n) {
              try {
                  u(n),
                  _.asyncPlugin[a] ? c(n, window[_.asyncPlugin[a]]) : (e = a,
                  t = s,
                  o = function(e) {
                      e || (_.asyncPlugin[a] = s,
                      e = window[s],
                      c(n, e))
                  }
                  ,
                  i = document.createElement("script"),
                  r = document.head,
                  "function" == typeof t && (o = t,
                  t = ""),
                  i.src = e,
                  i.setAttribute("name", t),
                  i.name = t,
                  i.setAttribute("crossorigin", "anonymous"),
                  i.crossorigin = "anonymous",
                  i.defer = !0,
                  i.hasLoaded = !1,
                  i.onreadystatechange = function() {
                      i.hasLoaded || i.readyState && "loaded" !== i.readyState && "complete" !== i.readyState || (i.hasLoaded = !0,
                      "function" == typeof o && o(!1),
                      setTimeout(function() {
                          r.contains(i) && r.removeChild(i)
                      }))
                  }
                  ,
                  i.onload = i.onreadystatechange,
                  i.onerror = function() {
                      "function" == typeof o && o(!0),
                      setTimeout(function() {
                          r.contains(i) && r.removeChild(i)
                      })
                  }
                  ,
                  "complete" === document.readyState ? r.appendChild(i) : window.addEventListener("load", function() {
                      r.appendChild(i)
                  }))
              } catch (e) {
                  console.log("error on below is caused by " + a + " "),
                  console.error(e)
              }
              var e, t, o, i, r
          }
      }))
  }
  ,
  _.prototype.publishPluginsLogs = function() {
      var e = _.installedPlugins.find(function(e) {
          return "reportAssetSpeed" === e.name
      });
      null != e && e.option.collectNotReportedLog(this)
  }
  ,
  _.prototype.uploadLogs = function(e, n) {
      var t;
      void 0 === e && (e = {}),
      void 0 === n && (n = {}),
      null != (t = this.lifeCycle) && t.emit("uploadLogs", e, n)
  }
  ,
  _.sessionID = "session-" + Date.now(),
  _.asyncPlugin = {},
  _.urls = {
      aegisCollect: "https://aegis.qq.com/collect",
      flog: "https://cdn-go.cn/vasdev/web_webpersistance_v2/v1.8.2/flog.core.min.js"
  },
  _), ln = new i({
      name: "offlineLog"
  }), o = ln = new i({
      name: "offlineLog",
      onNewAegis: function(e) {
          tn(U.urls.flog, e.config)
      }
  }), fn = (new i({
      name: "spa"
  }),
  new i({
      name: "spa",
      init: function() {
          history.pushState = this.wr("pushState") || history.pushState,
          history.replaceState = this.wr("replaceState") || history.replaceState,
          this.sendPv = this.sendPv.bind(this),
          this.onPageChange()
      },
      onPageChange: function() {
          window.addEventListener("replaceState", this.sendPv),
          window.addEventListener("pushState", this.sendPv),
          window.addEventListener("popstate", this.sendPv),
          window.addEventListener("hashchange", this.sendPv)
      },
      wr: function(t) {
          var o = history[t]
            , e = "__" + t + "__hasWrittenByTamSpa";
          return "function" == typeof o && !history[e] && (Object.defineProperty(history, e, {
              value: !0,
              enumerable: !1
          }),
          function() {
              var e = o.apply(this, arguments)
                , n = null;
              return "function" == typeof Event ? n = new Event(t) : (n = document.createEvent("HTMLEvents")).initEvent(t, !1, !0),
              window.dispatchEvent(n),
              e
          }
          )
      },
      sendPv: function() {
          var e = this;
          setTimeout(function() {
              var o = location.href
                , n = location.pathname + location.hash;
              e.$walk(function(e) {
                  var t = e.config.pvUrl;
                  t && n && n !== e.originFireUrl && (e.sendPipeline([function(e, n) {
                      n({
                          url: t + "?from=" + encodeURIComponent(o),
                          beanFilter: ["from"],
                          type: R.PV
                      })
                  }
                  ], R.PV)(null),
                  e.originFireUrl = n)
              })
          }, 0)
      },
      destroy: function() {
          window.removeEventListener("replaceState", this.option.sendPv),
          window.removeEventListener("pushState", this.option.sendPv),
          window.removeEventListener("popstate", this.option.sendPv)
      }
  }));
  function _(e) {
      var n, t, o, i, r, a = on.call(this, e) || this;
      a.sendNow = !1,
      a.isReportReady = !1,
      a.reportRequestQueue = [],
      a.speedLogPipeline = v([$(a), (i = a.config,
      r = {},
      function(e, n) {
          var t, o;
          i.speedSample ? (o = "object" == typeof i.repeat ? i.repeat : {
              repeat: i.repeat
          },
          t = +o.speed || +o.repeat || 5,
          Array.isArray(e) ? (o = e.filter(function(e) {
              var n = !r[e.url] || r[e.url] < t;
              return r[e.url] = 1 + ~~r[e.url],
              n
          })).length && n(o) : (!r[e.url] || r[e.url] < t) && (r[e.url] = 1 + ~~r[e.url],
          n(e))) : n(e)
      }
      ), (o = a,
      function(n, t) {
          Be(function(e) {
              o.extendBean("netType", e),
              t(n)
          })
      }
      ), function(e, n) {
          null != (t = a.lifeCycle) && t.emit("beforeReportSpeed", e);
          var t, o = a.config.beforeReportSpeed;
          if ((e = "function" == typeof o ? e.filter(function(e) {
              return !1 !== o(e)
          }) : e).length)
              return n(e)
      }
      , function(e) {
          return a.sendPipeline([function(e, n) {
              var t, o, i, r;
              n({
                  type: R.SPEED,
                  url: "" + a.config.speedUrl,
                  method: "post",
                  data: (n = e,
                  t = E(E({}, a.bean), {
                      from: a.getCurrentPageUrl()
                  }),
                  i = {
                      fetch: [],
                      static: [],
                      bridge: []
                  },
                  r = new FormData,
                  Array.isArray(n) ? n.forEach(function(e) {
                      var n = ye(e);
                      i[e.type].push(n)
                  }) : (o = ye(n),
                  i[n.type].push(o)),
                  r.append("payload", se(E({
                      duration: i
                  }, t))),
                  r),
                  log: e
              })
          }
          ], R.SPEED)(e)
      }
      ]),
      e.asyncPlugin = !0;
      try {
          "undefined" != typeof document && (e.uin = e.uin || (null != (n = document.cookie.match(/\buin=\D+(\d*)/)) ? n : [])[1] || (null != (t = document.cookie.match(/\bilive_uin=\D*(\d+)/)) ? t : [])[1] || ""),
          a.init(e),
          a.extendBean("sessionId", _.sessionID),
          a.extendBean("from", a.getCurrentPageUrl()),
          "undefined" != typeof document && a.extendBean("referer", encodeURIComponent(document.referrer || "")),
          e.ext1 && a.extendBean("ext1", encodeURIComponent(e.ext1)),
          e.ext2 && a.extendBean("ext2", encodeURIComponent(e.ext2)),
          e.ext3 && a.extendBean("ext3", encodeURIComponent(e.ext3))
      } catch (e) {
          console.warn(e),
          console.log("%cThe above error occurred in the process of initializing Aegis, which will affect your normal use of Aegis.\nIt is recommended that you contact us for feedback and thank you for your support.", "color: red"),
          a.sendSDKError(e)
      }
      return a
  }
  function dn() {
      this.constructor = rn
  }
  new i({
      name: "ie"
  }),
  new i({
      name: "onClose"
  });
  var pn = new i({
      name: "onClose",
      onNewAegis: function() {
          var t, o = this;
          r.desktop() ? (t = window.onunload,
          window.onunload = function() {
              for (var e = [], n = 0; n < arguments.length; n++)
                  e[n] = arguments[n];
              o.publishNotReportedLog(),
              null != t && t.call.apply(t, c([window], e))
          }
          ) : ne(this.publishNotReportedLog.bind(this), !0)
      },
      publishNotReportedLog: function() {
          var n = this;
          this.$walk(function(e) {
              e.sendNow = !0,
              e.publishPluginsLogs(),
              n.publishThrottlePipeLogs(e)
          })
      },
      publishThrottlePipeLogs: function(e) {
          null != e && e.speedLogPipeline([]),
          null != e && e.eventPipeline([]),
          null != e && e.customTimePipeline([]),
          null != e && e.normalLogPipeline([])
      }
  });
  return new i({
      name: "aid"
  }),
  U.use(Ve),
  U.use(Ne),
  U.use(be),
  U.use(Je),
  U.use(un),
  U.use(me),
  U.use(b),
  U.use(o),
  U.use(fn),
  U.use(pn),
  U.use(Ue),
  U
});
